{"map":{"version":3,"sources":["static/js/main.ed2b199d.chunk.js"],"names":["this","push","149","module","exports","__webpack_require__","p","150","151","158","160","172","195","197","213","392","399","__webpack_exports__","r","main","react","react_default","n","react_dom","react_dom_default","regenerator","regenerator_default","asyncToGenerator","lib","lib_default","web3","undefined","Login_Login_Login","a","Component","[object Object]","args","_this","super","state","loading","handleAuthenticate","publicAddress","signature","fetch","concat","body","JSON","stringify","headers","Content-Type","method","then","response","json","handleClick","Object","mark","_callee","onLoggedIn","coinbase","wrap","_context","prev","next","props","window","ethereum","alert","abrupt","enable","t0","eth","getCoinbase","sent","toLowerCase","setState","users","length","handleSignup","handleSignMessage","catch","err","stop","_ref2","_callee2","nonce","_context2","personal","sign","Error","_x","apply","arguments","createElement","className","onClick","jwt_decode_lib","jwt_decode_lib_default","dist_main","dist_main_default","Profile_Profile_Profile","user","username","handleChange","target","value","handleSubmit","accessToken","auth","_this$state","id","Authorization","payload","_this$props","onLoggedOut","_this$state2","seed","htmlFor","name","onChange","disabled","workflow","workflow_default","LS_KEY","App_App_App","handleLoggedIn","localStorage","setItem","handleLoggedOut","removeItem","ls","getItem","parse","src","alt","style","height","path","render","document","getElementById"],"mappings":"CAACA,KAAK,mCAAqCA,KAAK,oCAAsC,IAAIC,KAAK,CAAC,CAAC,GAAG,CAE9FC,IACA,SAAUC,EAAQC,EAASC,GAEjCF,EAAOC,QAAUC,EAAoBC,EAAI,sCAInCC,IACA,SAAUJ,EAAQC,EAASC,GAEjCF,EAAOC,QAAUC,EAAoB,MAK/BG,IACA,SAAUL,EAAQC,EAASC,KAM3BI,IACA,SAAUN,EAAQC,EAASC,KAM3BK,IACA,SAAUP,EAAQC,EAASC,KAM3BM,IACA,SAAUR,EAAQC,KAMlBQ,IACA,SAAUT,EAAQC,KAMlBS,IACA,SAAUV,EAAQC,KAMlBU,IACA,SAAUX,EAAQC,KAMlBW,IACA,SAAUZ,EAAQC,EAASC,KAM3BW,IACA,SAAUb,EAAQc,EAAqBZ,GAE7C,aAEAA,EAAoBa,EAAED,GAGZZ,EAAoB,KAA9B,IAGIc,EAAOd,EAAoB,KAG3Be,EAAQf,EAAoB,GAC5BgB,EAA6BhB,EAAoBiB,EAAEF,GAGnDG,EAAYlB,EAAoB,KAChCmB,EAAiCnB,EAAoBiB,EAAEC,GAMvDE,GAHUpB,EAAoB,KAGhBA,EAAoB,IAClCqB,EAAmCrB,EAAoBiB,EAAEG,GAGzDE,EAAmBtB,EAAoB,IAMvCuB,GAHcvB,EAAoB,KAG5BA,EAAoB,MAC1BwB,EAA2BxB,EAAoBiB,EAAEM,GAGrD,IAAIE,OAAKC,EACT,MAAMC,UAA0BX,EAAcY,EAAEC,UAAUC,eAAeC,GAAM,IAAIC,EAAMC,SAASF,GAAMC,EAAMrC,KAAKA,KAAKuC,MAAM,CAACC,SAAQ,GACrIxC,KAAKyC,mBAAmB,EAAEC,cAAAA,EAAcC,UAAAA,KAAaC,MAAM,GAAGC,OAAO,iDAAiD,SAAS,CAACC,KAAKC,KAAKC,UAAU,CAACN,cAAAA,EAAcC,UAAAA,IAAYM,QAAQ,CAACC,eAAe,oBAAoBC,OAAO,SAASC,KAAKC,GAAUA,EAASC,QAAQtD,KAAKuD,YAAyBC,OAAO7B,EAAkC,EAAzC6B,CAAyD9B,EAAoBO,EAAEwB,MAAK,SAASC,IAAU,IAAIC,EAAWC,EAASlB,EAAc,OAAOhB,EAAoBO,EAAE4B,MAAK,SAAkBC,GAAU,OAAQ,OAAOA,EAASC,KAAKD,EAASE,MAAM,KAAK,EACviB,GADyiBL,EAAWtB,EAAM4B,MAAMN,WAC7jBO,OAAOC,SAAS,CAACL,EAASE,KAAK,EAAE,MAAsD,OAA/CE,OAAOE,MAAM,kCAAyCN,EAASO,OAAO,UAAU,KAAK,EAAE,GAAGvC,EAAK,CAACgC,EAASE,KAAK,GAAG,MAAuC,OAAhCF,EAASC,KAAK,EAAED,EAASE,KAAK,EAASE,OAAOC,SAASG,SAAS,KAAK,EAExOxC,EAAK,IAAID,EAAYI,EAAEiC,OAAOC,UAAUL,EAASE,KAAK,GAAG,MAAM,KAAK,GAAiG,OAA9FF,EAASC,KAAK,GAAGD,EAASS,GAAGT,EAAgB,MAAE,GAAGI,OAAOE,MAAM,+BAAsCN,EAASO,OAAO,UAAU,KAAK,GAAoB,OAAjBP,EAASE,KAAK,GAAUlC,EAAK0C,IAAIC,cAAc,KAAK,GAA0B,GAAvBb,EAASE,EAASY,KAAiB,CAACZ,EAASE,KAAK,GAAG,MAAuD,OAAhDE,OAAOE,MAAM,mCAA0CN,EAASO,OAAO,UAAU,KAAK,GAAG3B,EAAckB,EAASe,cAActC,EAAMuC,SAAS,CAACpC,SAAQ,IACvdI,MAAM,GAAGC,OAAO,iDAAiD,yBAAyBA,OAAOH,IAAgBU,KAAKC,GAAUA,EAASC,QACxIF,KAAKyB,GAAOA,EAAMC,OAAOD,EAAM,GAAGxC,EAAM0C,aAAarC,IACrDU,KAAKf,EAAM2C,mBACX5B,KAAKf,EAAMI,oBACXW,KAAKO,GAAYsB,MAAMC,IAAMhB,OAAOE,MAAMc,GAAK7C,EAAMuC,SAAS,CAACpC,SAAQ,MAAW,KAAK,GAAG,IAAI,MAAM,OAAOsB,EAASqB,UAAUzB,EAAQ,KAAK,CAAC,CAAC,EAAE,UAAU1D,KAAKgF,kBAA+B,WAAW,IAAII,EAAM5B,OAAO7B,EAAkC,EAAzC6B,CAAyD9B,EAAoBO,EAAEwB,MAAK,SAAS4B,GAAS3C,cAACA,EAAa4C,MAACA,IAAQ,IAAI3C,EAAU,OAAOjB,EAAoBO,EAAE4B,MAAK,SAAmB0B,GAAW,OAAQ,OAAOA,EAAUxB,KAAKwB,EAAUvB,MAAM,KAAK,EAAoC,OAAlCuB,EAAUxB,KAAK,EAAEwB,EAAUvB,KAAK,EAASlC,EAAK0C,IAAIgB,SAASC,KAAK,mCAAmC5C,OAAOyC,GAAO5C,EAAc,IAChlB,KAAK,EAA2B,OAAzBC,EAAU4C,EAAUb,KAAYa,EAAUlB,OAAO,SAAS,CAAC3B,cAAAA,EAAcC,UAAAA,IAAY,KAAK,EAAsD,MAApD4C,EAAUxB,KAAK,EAAEwB,EAAUhB,GAAGgB,EAAiB,MAAE,GAAS,IAAIG,MAAM,sDAAsD,KAAK,GAAG,IAAI,MAAM,OAAOH,EAAUJ,UAAUE,EAAS,KAAK,CAAC,CAAC,EAAE,SAAS,OAAO,SAASM,GAAI,OAAOP,EAAMQ,MAAM5F,KAAK6F,YADrJ,GACsK7F,KAAK+E,aAAarC,GAAuBE,MAAM,GAAGC,OAAO,iDAAiD,UAAU,CAACC,KAAKC,KAAKC,UAAU,CAACN,cAAAA,IAAgBO,QAAQ,CAACC,eAAe,oBAAoBC,OAAO,SAASC,KAAKC,GAAUA,EAASC,QAAWnB,SAAS,MAAMK,EAAQxC,KAAKuC,MAAMC,QAAQ,OAAmBnB,EAAcY,EAAE6D,cAAc,MAAM,KAAkBzE,EAAcY,EAAE6D,cAAc,SAAS,CAACC,UAAU,wBAAwBC,QAAQhG,KAAKuD,aAAaf,EAAQ,aAAa,yBAInzBnC,EAAoB,KAA1C,IAGI4F,EAAiB5F,EAAoB,IACrC6F,EAAsC7F,EAAoBiB,EAAE2E,GAG5DE,EAAY9F,EAAoB,KAChC+F,EAAiC/F,EAAoBiB,EAAE6E,GAG3D,MAAME,UAAgChF,EAAcY,EAAEC,UAAUC,eAAeC,GAAME,SAASF,GAAMpC,KAAKuC,MAAM,CAACC,SAAQ,EAAM8D,UAAKvE,EAAUwE,SAAS,IAAIvG,KAAKwG,aAAa,EAAEC,QAAQC,MAAAA,OAAW1G,KAAK4E,SAAS,CAAC2B,SAASG,KAAU1G,KAAK2G,aAAa,KAAK,MAAMC,EAAY5G,KAAKiE,MAAM4C,KAAKD,YAAkBE,EAAY9G,KAAKuC,MAAM+D,EAAKQ,EAAYR,KAAKC,EAASO,EAAYP,SAASvG,KAAK4E,SAAS,CAACpC,SAAQ,IAAW8D,EAAmG1D,MAAM,GAAGC,OAAO,iDAAiD,WAAWA,OAAOyD,EAAKS,IAAI,CAACjE,KAAKC,KAAKC,UAAU,CAACuD,SAAAA,IAAWtD,QAAQ,CAAC+D,cAAc,UAAUnE,OAAO+D,GAAa1D,eAAe,oBAAoBC,OAAO,UAAUC,KAAKC,GAAUA,EAASC,QAAQF,KAAKkD,GAAMtG,KAAK4E,SAAS,CAACpC,SAAQ,EAAM8D,KAAAA,KAAQrB,MAAMC,IAAMhB,OAAOE,MAAMc,GAAKlF,KAAK4E,SAAS,CAACpC,SAAQ,MAAxc0B,OAAOE,MAAM,yEAAycjC,oBAAoB,MAAMyE,EAAY5G,KAAKiE,MAAM4C,KAAKD,YAAmEG,EAAtCb,GAAAA,CAAyBU,GAA2BK,QAAQF,GAAGnE,MAAM,GAAGC,OAAO,iDAAiD,WAAWA,OAAOkE,GAAI,CAAC9D,QAAQ,CAAC+D,cAAc,UAAUnE,OAAO+D,MAAgBxD,KAAKC,GAAUA,EAASC,QAAQF,KAAKkD,GAAMtG,KAAK4E,SAAS,CAAC0B,KAAAA,KAAQrB,MAAMf,OAAOE,OAAQjC,SAAS,MAAM+E,EAAYlH,KAAKiE,MAAM2C,EAAYM,EAAYL,KAAKD,YAAYO,EAAYD,EAAYC,YAAoEzE,EAAtCwD,GAAAA,CAAyBU,GAAuCK,QAAQvE,cAAoB0E,EAAapH,KAAKuC,MAAMC,EAAQ4E,EAAa5E,QAAQ8D,EAAKc,EAAad,KAAWC,EAASD,GAAMA,EAAKC,SAAS,OAAmBlF,EAAcY,EAAE6D,cAAc,MAAM,CAACC,UAAU,WAAwB1E,EAAcY,EAAE6D,cAAc,IAAI,KAAK,gBAA6BzE,EAAcY,EAAE6D,cAAcM,EAAkBnE,EAAE,CAACoF,KAAK3E,KAA8BrB,EAAcY,EAAE6D,cAAc,MAAM,KAAK,kBAAkBS,EAAsBlF,EAAcY,EAAE6D,cAAc,MAAM,KAAKS,GAAU,WAAW,wBAAqClF,EAAcY,EAAE6D,cAAc,MAAM,KAAKpD,IAA6BrB,EAAcY,EAAE6D,cAAc,MAAM,KAAkBzE,EAAcY,EAAE6D,cAAc,QAAQ,CAACwB,QAAQ,YAAY,qBAAkCjG,EAAcY,EAAE6D,cAAc,QAAQ,CAACyB,KAAK,WAAWC,SAASxH,KAAKwG,eAA4BnF,EAAcY,EAAE6D,cAAc,SAAS,CAAC2B,SAASjF,EAAQwD,QAAQhG,KAAK2G,cAAc,WAAwBtF,EAAcY,EAAE6D,cAAc,IAAI,KAAkBzE,EAAcY,EAAE6D,cAAc,SAAS,CAACE,QAAQmB,GAAa,aAE//E,IAAIO,EAAWrH,EAAoB,KAC/BsH,EAAgCtH,EAAoBiB,EAAEoG,GAI1D,MAAME,EAAO,2BAA2B,MAAMC,UAAoBxG,EAAcY,EAAEC,UAAUC,eAAeC,GAAME,SAASF,GAAMpC,KAAKuC,MAAM,GAAGvC,KAAK8H,eAAejB,IAAOkB,aAAaC,QAAQJ,EAAO7E,KAAKC,UAAU6D,IAAO7G,KAAK4E,SAAS,CAACiC,KAAAA,KAAS7G,KAAKiI,gBAAgB,KAAKF,aAAaG,WAAWN,GAAQ5H,KAAK4E,SAAS,CAACiC,UAAK9E,KAAeI,oBAChV,MAAMgG,EAAGjE,OAAO6D,aAAaK,QAAQR,GAAcf,EAAKsB,GAAIpF,KAAKsF,MAAMF,GAAInI,KAAK4E,SAAS,CAACiC,KAAAA,IAAQ1E,SAAS,MAAM0E,EAAK7G,KAAKuC,MAAMsE,KAAK,OAAmBxF,EAAcY,EAAE6D,cAAc,MAAM,CAACC,UAAU,OAAoB1E,EAAcY,EAAE6D,cAAc,SAAS,CAACC,UAAU,cAA2B1E,EAAcY,EAAE6D,cAAc,MAAM,CAACwC,IAAIX,EAAiB1F,EAClWsG,IAAI,OAAOC,MAAM,CAACC,OAAO,SAAsBpH,EAAcY,EAAE6D,cAAc,KAAK,CAACC,UAAU,aAAa,wCAAqD1E,EAAcY,EAAE6D,cAAc,MAAM,CAACC,UAAU,aAAac,EAAkBxF,EAAcY,EAAE6D,cAAcO,EAAwB,CAACQ,KAAKA,EAAKM,YAAYnH,KAAKiI,kBAA+B5G,EAAcY,EAAE6D,cAAc9D,EAAkB,CAAC2B,WAAW3D,KAAK8H,oBAKhatE,OAAOrC,EAAa,OAApBqC,CAAuB,CAACkF,KAAW,oBAA8BlH,EAAkBS,EAAE0G,OAAoBtH,EAAcY,EAAE6D,cAAc+B,EAAY,MAAMe,SAASC,eAAe,WAI/K,CAAC,CAAC,IAAI,EAAE"},"code":"(this[\"webpackJsonplogin-with-metamask\"]=this[\"webpackJsonplogin-with-metamask\"]||[]).push([[0],{149:function(e,t,n){e.exports=n.p+\"static/media/workflow.5206274d.jpg\"},150:function(e,t,n){e.exports=n(399)},151:function(e,t,n){},158:function(e,t,n){},160:function(e,t,n){},172:function(e,t){},195:function(e,t){},197:function(e,t){},213:function(e,t){},392:function(e,t,n){},399:function(e,t,n){\"use strict\";n.r(t);n(151);var a=n(145),s=n(4),o=n.n(s),r=n(146),i=n.n(r),c=(n(158),n(9)),l=n.n(c),h=n(73),u=(n(160),n(147)),d=n.n(u);let p=void 0;class m extends o.a.Component{constructor(...e){var t;super(...e),t=this,this.state={loading:!1},this.handleAuthenticate=({publicAddress:e,signature:t})=>fetch(\"\".concat(\"https://loginwithmetamaskapi.herokuapp.com/api\",\"/auth\"),{body:JSON.stringify({publicAddress:e,signature:t}),headers:{\"Content-Type\":\"application/json\"},method:\"POST\"}).then(e=>e.json()),this.handleClick=Object(h.a)(l.a.mark((function e(){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props.onLoggedIn,window.ethereum){e.next=4;break}return window.alert(\"Please install MetaMask first.\"),e.abrupt(\"return\");case 4:if(p){e.next=15;break}return e.prev=5,e.next=8,window.ethereum.enable();case 8:p=new d.a(window.ethereum),e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(5),window.alert(\"You need to allow MetaMask.\"),e.abrupt(\"return\");case 15:return e.next=17,p.eth.getCoinbase();case 17:if(a=e.sent){e.next=21;break}return window.alert(\"Please activate MetaMask first.\"),e.abrupt(\"return\");case 21:s=a.toLowerCase(),t.setState({loading:!0}),fetch(\"\".concat(\"https://loginwithmetamaskapi.herokuapp.com/api\",\"/users?publicAddress=\").concat(s)).then(e=>e.json()).then(e=>e.length?e[0]:t.handleSignup(s)).then(t.handleSignMessage).then(t.handleAuthenticate).then(n).catch(e=>{window.alert(e),t.setState({loading:!1})});case 24:case\"end\":return e.stop()}}),e,null,[[5,11]])}))),this.handleSignMessage=function(){var e=Object(h.a)(l.a.mark((function e({publicAddress:t,nonce:n}){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.eth.personal.sign(\"I am signing my one-time nonce: \".concat(n),t,\"\");case 3:return a=e.sent,e.abrupt(\"return\",{publicAddress:t,signature:a});case 7:throw e.prev=7,e.t0=e.catch(0),new Error(\"You need to sign the message to be able to log in.\");case 10:case\"end\":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.handleSignup=e=>fetch(\"\".concat(\"https://loginwithmetamaskapi.herokuapp.com/api\",\"/users\"),{body:JSON.stringify({publicAddress:e}),headers:{\"Content-Type\":\"application/json\"},method:\"POST\"}).then(e=>e.json())}render(){const e=this.state.loading;return o.a.createElement(\"div\",null,o.a.createElement(\"button\",{className:\"Login-button Login-mm\",onClick:this.handleClick},e?\"Loading...\":\"Login with MetaMask\"))}}n(392);var g=n(74),w=n.n(g),b=n(148),f=n.n(b);class k extends o.a.Component{constructor(...e){super(...e),this.state={loading:!1,user:void 0,username:\"\"},this.handleChange=({target:{value:e}})=>{this.setState({username:e})},this.handleSubmit=()=>{const e=this.props.auth.accessToken,t=this.state,n=t.user,a=t.username;this.setState({loading:!0}),n?fetch(\"\".concat(\"https://loginwithmetamaskapi.herokuapp.com/api\",\"/users/\").concat(n.id),{body:JSON.stringify({username:a}),headers:{Authorization:\"Bearer \".concat(e),\"Content-Type\":\"application/json\"},method:\"PATCH\"}).then(e=>e.json()).then(e=>this.setState({loading:!1,user:e})).catch(e=>{window.alert(e),this.setState({loading:!1})}):window.alert(\"The user id has not been fetched yet. Please try again in 5 seconds.\")}}componentDidMount(){const e=this.props.auth.accessToken,t=w()(e).payload.id;fetch(\"\".concat(\"https://loginwithmetamaskapi.herokuapp.com/api\",\"/users/\").concat(t),{headers:{Authorization:\"Bearer \".concat(e)}}).then(e=>e.json()).then(e=>this.setState({user:e})).catch(window.alert)}render(){const e=this.props,t=e.auth.accessToken,n=e.onLoggedOut,a=w()(t).payload.publicAddress,s=this.state,r=s.loading,i=s.user,c=i&&i.username;return o.a.createElement(\"div\",{className:\"Profile\"},o.a.createElement(\"p\",null,\"Logged in as \",o.a.createElement(f.a,{seed:a})),o.a.createElement(\"div\",null,\"My username is \",c?o.a.createElement(\"pre\",null,c):\"not set.\",\" My publicAddress is \",o.a.createElement(\"pre\",null,a)),o.a.createElement(\"div\",null,o.a.createElement(\"label\",{htmlFor:\"username\"},\"Change username: \"),o.a.createElement(\"input\",{name:\"username\",onChange:this.handleChange}),o.a.createElement(\"button\",{disabled:r,onClick:this.handleSubmit},\"Submit\")),o.a.createElement(\"p\",null,o.a.createElement(\"button\",{onClick:n},\"Logout\")))}}var S=n(149),v=n.n(S);const E=\"login-with-metamask:auth\";class y extends o.a.Component{constructor(...e){super(...e),this.state={},this.handleLoggedIn=e=>{localStorage.setItem(E,JSON.stringify(e)),this.setState({auth:e})},this.handleLoggedOut=()=>{localStorage.removeItem(E),this.setState({auth:void 0})}}componentDidMount(){const e=window.localStorage.getItem(E),t=e&&JSON.parse(e);this.setState({auth:t})}render(){const e=this.state.auth;return o.a.createElement(\"div\",{className:\"App\"},o.a.createElement(\"header\",{className:\"App-header\"},o.a.createElement(\"img\",{src:v.a,alt:\"logo\",style:{height:\"95%\"}}),o.a.createElement(\"h1\",{className:\"App-title\"},\"Welcome to Login with MetaMask Demo\")),o.a.createElement(\"div\",{className:\"App-intro\"},e?o.a.createElement(k,{auth:e,onLoggedOut:this.handleLoggedOut}):o.a.createElement(m,{onLoggedIn:this.handleLoggedIn})))}}Object(a.config)({path:\".env.production\"}),i.a.render(o.a.createElement(y,null),document.getElementById(\"root\"))}},[[150,1,2]]]);","extractedComments":[]}